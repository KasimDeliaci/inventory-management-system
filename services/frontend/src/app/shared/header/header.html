<header class="page-header">
  <h1>{{ title }}</h1>
  <div class="actions">
    <div class="search">
      <span class="icon">üîç</span>
      <input
        type="text"
        [value]="query"
        (input)="onInput($any($event.target).value)"
        placeholder="Search" />
      <button class="ghost" *ngIf="query" (click)="clearSearch.emit()">‚úñ</button>
    </div>
    
    <button class="danger"
            type="button"
            [disabled]="deletableCount === 0"
            (click)="deleteSelected.emit()">
      <img class="i" src="assets/icons/trash.svg" alt="delete" />
      Delete <span *ngIf="deletableCount">({{ deletableCount }})</span>
    </button>
    
    <div class="filter-container" *ngIf="showFilters">
      <button class="filter" type="button" (click)="openFilters.emit()">
        <img class="i" src="assets/icons/filter.svg" alt="filters" />
        Filters
        <span class="filter-indicator" *ngIf="hasActiveFilter"></span>
      </button>
      
      <!-- Product Status Filters -->
      <div class="filter-dropdown" *ngIf="filterOpen && isProductPage">
        <button
          class="filter-option"
          [class.active]="statusFilter === 'all'"
          (click)="onFilterClick('all')">
          All
        </button>
        <button
          class="filter-option ok"
          [class.active]="statusFilter === 'ok'"
          (click)="onFilterClick('ok')">
          <span class="status-dot ok"></span>
          OK
        </button>
        <button
          class="filter-option warning"
          [class.active]="statusFilter === 'warning'"
          (click)="onFilterClick('warning')">
          <span class="status-dot warning"></span>
          Warning
        </button>
        <button
          class="filter-option critical"
          [class.active]="statusFilter === 'critical'"
          (click)="onFilterClick('critical')">
          <span class="status-dot critical"></span>
          Critical
        </button>
      </div>
      
      <!-- Customer Segment Filters -->
      <div class="filter-dropdown" *ngIf="filterOpen && isCustomerPage">
        <button
          class="filter-option"
          [class.active]="segmentFilter === 'all'"
          (click)="onFilterClick('all')">
          All Segments
        </button>
        <button
          class="filter-option individual"
          [class.active]="segmentFilter === 'individual'"
          (click)="onFilterClick('individual')">
          <span class="segment-badge individual"></span>
          Individual
        </button>
        <button
          class="filter-option sme"
          [class.active]="segmentFilter === 'sme'"
          (click)="onFilterClick('sme')">
          <span class="segment-badge sme"></span>
          SME
        </button>
        <button
          class="filter-option institutional"
          [class.active]="segmentFilter === 'institutional'"
          (click)="onFilterClick('institutional')">
          <span class="segment-badge institutional"></span>
          Institutional
        </button>
      </div>
      
      <!-- Campaign Filters -->
      <div class="filter-dropdown" *ngIf="filterOpen && isCampaignPage">
        <!-- Assignment Type Filter (First Level) -->
        <div class="filter-section">
          <div class="filter-label">Assignment</div>
          <button
            class="filter-option"
            [class.active]="campaignAssignmentFilter === 'all'"
            (click)="onCampaignAssignmentFilterClick('all')">
            All Assignments
          </button>
          <button
            class="filter-option"
            [class.active]="campaignAssignmentFilter === 'product'"
            (click)="onCampaignAssignmentFilterClick('product')">
            Product-based
          </button>
          <button
            class="filter-option"
            [class.active]="campaignAssignmentFilter === 'customer'"
            (click)="onCampaignAssignmentFilterClick('customer')">
            Customer-based
          </button>
        </div>
        
        <!-- Campaign Type Filter (Only for Product-based) -->
        <div class="filter-section" *ngIf="campaignAssignmentFilter === 'product'">
          <div class="filter-label">Campaign Type</div>
          <button
            class="filter-option"
            [class.active]="campaignTypeFilter === 'all'"
            (click)="onCampaignTypeFilterClick('all')">
            All Types
          </button>
          <button
            class="filter-option discount"
            [class.active]="campaignTypeFilter === 'discount'"
            (click)="onCampaignTypeFilterClick('discount')">
            <span class="type-badge discount"></span>
            Discount
          </button>
          <button
            class="filter-option promotion"
            [class.active]="campaignTypeFilter === 'promotion'"
            (click)="onCampaignTypeFilterClick('promotion')">
            <span class="type-badge promotion"></span>
            Promotion
          </button>
          <button
            class="filter-option seasonal"
            [class.active]="campaignTypeFilter === 'seasonal'"
            (click)="onCampaignTypeFilterClick('seasonal')">
            <span class="type-badge seasonal"></span>
            Seasonal
          </button>
          <button
            class="filter-option clearance"
            [class.active]="campaignTypeFilter === 'clearance'"
            (click)="onCampaignTypeFilterClick('clearance')">
            <span class="type-badge clearance"></span>
            Clearance
          </button>
        </div>
        
        <!-- Active/Inactive Filter (Always shown) -->
        <div class="filter-section">
          <div class="filter-label">Status</div>
          <button
            class="filter-option"
            [class.active]="campaignActiveFilter === 'all'"
            (click)="onCampaignActiveFilterClick('all')">
            All Campaigns
          </button>
          <button
            class="filter-option active"
            [class.active]="campaignActiveFilter === 'active'"
            (click)="onCampaignActiveFilterClick('active')">
            <span class="status-dot active"></span>
            Active
          </button>
          <button
            class="filter-option inactive"
            [class.active]="campaignActiveFilter === 'inactive'"
            (click)="onCampaignActiveFilterClick('inactive')">
            <span class="status-dot inactive"></span>
            Inactive
          </button>
        </div>
      </div>
      
      <!-- Order Filters -->
      <div class="filter-dropdown" *ngIf="filterOpen && isOrderPage">
        <!-- Type Filter -->
        <div class="filter-section">
          <button
            class="filter-option"
            [class.active]="typeFilter === 'all'"
            (click)="onOrderTypeFilterClick('all')">
            All Orders
          </button>
          <button
            class="filter-option"
            [class.active]="typeFilter === 'purchase'"
            (click)="onOrderTypeFilterClick('purchase')">
            Purchase Orders
          </button>
          <button
            class="filter-option"
            [class.active]="typeFilter === 'sales'"
            (click)="onOrderTypeFilterClick('sales')">
            Sales Orders
          </button>
        </div>
        
        <!-- Status Filter (shows different options based on type) -->
        <div class="filter-section" *ngIf="typeFilter !== 'all'">
          <div class="filter-label">Status</div>
          <button
            class="filter-option"
            [class.active]="orderStatusFilter === 'all'"
            (click)="onOrderStatusFilterClick('all')">
            All Statuses
          </button>
          
          <!-- Purchase Order Statuses -->
          <ng-container *ngIf="typeFilter === 'purchase'">
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'placed'"
              (click)="onOrderStatusFilterClick('placed')">
              Placed
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'in_transit'"
              (click)="onOrderStatusFilterClick('in_transit')">
              In Transit
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'received'"
              (click)="onOrderStatusFilterClick('received')">
              Received
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'canceled'"
              (click)="onOrderStatusFilterClick('canceled')">
              Canceled
            </button>
          </ng-container>
          
          <!-- Sales Order Statuses -->
          <ng-container *ngIf="typeFilter === 'sales'">
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'pending'"
              (click)="onOrderStatusFilterClick('pending')">
              Pending
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'allocated'"
              (click)="onOrderStatusFilterClick('allocated')">
              Allocated
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'in_transit'"
              (click)="onOrderStatusFilterClick('in_transit')">
              In Transit
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'delivered'"
              (click)="onOrderStatusFilterClick('delivered')">
              Delivered
            </button>
            <button
              class="filter-option"
              [class.active]="orderStatusFilter === 'canceled'"
              (click)="onOrderStatusFilterClick('canceled')">
              Canceled
            </button>
          </ng-container>
        </div>
      </div>
    </div>
    
    <!-- Default Add Button -->
    <button class="primary" type="button" *ngIf="showAddButton" (click)="onAddClick()">
      {{ addButtonText }}
    </button>
    
    <!-- Custom Action Buttons -->
    <button 
      class="primary" 
      type="button" 
      *ngFor="let btn of customActionButtons"
      (click)="onCustomActionClick(btn.action)">
      {{ btn.text }}
    </button>
  </div>
</header>